<!DOCTYPE html>
<html>
  <head>
    <title>April</title>

    {% assets filters="cssmin", output="gen/style.css", "css/reset.css", "css/base.css" %}
      <link rel="stylesheet" href="{{ ASSET_URL }}">
    {% endassets %}

  </head>
  <body>
     
    <div class="container">

      <div class="loading-screen" style="background-color: #000; width: 100%; height: 100%; position: absolute; z-index: 2;">

      </div>

      <h1>April</h1>
      
      <video audio="muted" autoplay loop>
        <!--<source src="//dns4jlfurg7hp.cloudfront.net/videos/petra.ogv" type="video/ogg; codecs=&quot;theora, vorbis&quot;">-->
        <source src="//jeffmicklos.s3.amazonaws.com/april/web/bg_ipod.mp4" type="video/mp4; codecs=&quot;avc1.42E01E, mp4a.40.2&quot;">
      </video>

      {% block content %}
      {% endblock %}
    </div>

    <script src="//cdnjs.cloudflare.com/ajax/libs/zepto/1.0/zepto.min.js"></script>

    <script>

      April = {

        init: function() {

          this.w = $(window);
          this.video = $('video');
          this.container = $('.container');
          this.loadingScreen = $('.loading-screen');

          this.arrangeElements();
          this.w.on('resize', $.proxy(this.arrangeElements, this));

          // Once the video is ready to play, fade out the loading screen
          if(this.video.get(0).buffered.length) {
            this.hideLoadingScreen()
          } else {
            this.video.on('canplay', $.proxy(this.hideLoadingScreen, this));
          }

        },

        arrangeElements: function() {
          this.fitVideo();
          this.verticalCenter($('h1'));
          this.container.css('height', this.w.height());
        },

        hideLoadingScreen: function() {
          this.loadingScreen.animate({
            opacity: 0
          }, 1000);
        },

        fitVideo: function() {
          var videoW = 960;
          var videoH = 544;
          var windowW = this.w.width();
          var windowH = this.w.height();

          var videoRatio = videoW / videoH;
          var windowRatio = windowW / windowH;

          if(windowRatio < videoRatio) {
            this.video.css({
              height: '100%',
              width: 'auto'
            });
          } else {
            this.video.css({
              height: 'auto',
              width: '100%',
            });
          }
        },

        verticalCenter: function(element) {
          element.css({
            position: 'absolute',
            top: '50%',
            marginTop: -(element.height() / 2)
          });
        }

      };

      April.init();

    </script>
     
  </body>
</html>