window.April=window.April||{};April.ScrollWatcher=function(slider){this.slider=slider;this._locked=false;$(document).on('mousewheel DOMMouseScroll',$.proxy(this.onMouseWheel,this));};April.ScrollWatcher.prototype.SCROLL_DURATION=400;April.ScrollWatcher.prototype.onMouseWheel=function(event){var self=this;var delta=event.wheelDeltaY||-1*event.deltaY;event.preventDefault();event.stopPropagation();if(this._locked){return;}
this._locked=true;if(delta>0){$('.container').first().velocity('scroll',{duration:500,easing:'easeOutBack'});}else{$('.container').last().velocity('scroll',{duration:500,easing:'easeOutBack'});}
setTimeout(function(){self._locked=false;},this.SCROLL_DURATION);};April=$.extend(window.April||{},{init:function(){this.w=$(window);this.footer=$('.footer');this.container=$('.container');this.contentContainer=$('.content');this.loadingScreen=$('.loading-screen');new April.ScrollWatcher();this.store=null;this.arrangeElements();this.w.on('resize',$.proxy(this.arrangeElements,this));$('.download-link').on('click',$.proxy(this.onDownload,this));$('.email').on('submit',$.proxy(this.onEmailSubmit,this));this.hideLoadingScreen();this.getScript('https://cdn.firebase.com/v0/firebase.js',$.proxy(this.onFirebaseLoad,this));},arrangeElements:function(){this.verticalCenter(this.contentContainer);this.horizontalCenter(this.contentContainer);this.container.css('height',this.w.height());},hideLoadingScreen:function(){var self=this;this.loadingScreen.animate({opacity:0},1000,'ease',function(){self.loadingScreen.remove();});},onDownload:function(event){ga('send','event','Music','Download',$(event.currentTarget).data('song'));},onEmailSubmit:function(event){event.preventDefault();var button=$('.email-submit');var email=$('.email-value').val();var userRef;if(email!==''&&email.indexOf('@')!==-1&&this.store){userRef=this.store.push();userRef.child('timestamp').set(Firebase.ServerValue.TIMESTAMP);userRef.child('data').set({email:email});button.val('Thank You <3');}else{button.val('Try Again');}},onFirebaseLoad:function(){var self=this;this.store=new Firebase('https://april.firebaseio.com/');if(!IS_MOBILE){this.w.on('load',function(){setTimeout(function(){self.footer.velocity({bottom:0},{duration:500,easing:[0.175,0.885,0.32,1.275]});},2000);});}},verticalCenter:function(element){var position=element.css('position')=='relative'?'relative':null;element.css({position:position||'absolute',top:'50%',marginTop:-(element.height()/2)});},horizontalCenter:function(element){var position=element.css('position')=='relative'?'relative':null;element.css({position:position||'absolute',left:'50%',marginLeft:-(element.width()/2)});},getScript:function(src,func){var script=document.createElement('script');script.async='async';script.src=src;if(func){script.onload=func;}
document.getElementsByTagName('head')[0].appendChild(script);}});